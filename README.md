## ë§ˆì¸ë“œìŠ¤ìœ„ì¹˜ì•¤ì½”ì›¨ì´ë¸Œ ê³¼ì œ

### gps â†’ geolocation â†’ ê²½ë„, ìœ„ë„ ìœ„ì¹˜ ê°€ì ¸ì˜´

### í–‰ì •ë™ â†’ kakao map api

### ë‚ ì”¨ â†’ open api

---

### api ìš”ì²­ì„ ì¤„ì´ê¸° ìœ„í•´ í•  ìˆ˜ ìˆëŠ” ê²ƒ

1. ~~ìœ„ì¹˜ë¥¼ ì¶”ì í•˜ë‹¤ê°€ ë°”ë€Œë©´ â€˜ì´ ê³³ì´ ë§ë‚˜ìš”?â€™ ë¬¼ìŒ ë’¤ì— ë²„íŠ¼ ëˆ„ë¥´ë©´ apiìš”ì²­ (ë°°ë¯¼, ì¿ íŒ¡ì´ì¸  st)~~
    1. ~~ë¶ˆí•„ìš”í•œ apiìš”ì²­ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆìœ¼ë‚˜ íƒ€ ë‚ ì”¨ ì–´í”Œì— ë¹„êµí•´ ë´¤ì„ ë•Œ ì í•©í•˜ì§€ ì•Šì€ ë°©ë²•~~
    2. ~~ìë™ ë°˜ì˜ì´ ì•ˆë˜ê¸° ë•Œë¬¸ì— UX ë¶ˆí¸~~
2. ì¼ì •í•œ ê±°ë¦¬ë‚´ì—ì„œëŠ” api ìš”ì²­ì„ í•˜ì§€ ì•ŠìŒ (ex. 50m)
    1. ì´ë™ì´ ì ì„ ë•Œ apiìš”ì²­ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ
    2. ì§€ì—­ì˜ ê²½ê³„ì— ìˆì„ ë•ŒëŠ” í–‰ì •ë™ì´ ë°˜ì˜ì´ ì•ˆë  ìˆ˜ ìˆìŒ
3. `watchposition` ì„¤ì • ì¡°ì ˆí•¨ gps ë°›ì•„ì˜¤ëŠ” ì£¼ê¸°ë¥¼ ì¤„ì„(gps ìš”ì²­ì„ ì¤„ì„)
    1. ì¼ì • ì‹œê°„ë§ˆë‹¤ apiê°€ ìš”ì²­ë¨ -> ì±Œë¦°ì§€!

### âœ… **ì™œ `watchPosition`ì„ `clearWatch`í•˜ì§€ ì•Šìœ¼ë©´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ìƒê¸¸ê¹Œ?**

---

### ğŸ” **1ï¸âƒ£ `watchPosition`ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì´í•´í•˜ì**

`navigator.geolocation.watchPosition()`ì€ ë‹¨ìˆœí•œ í•¨ìˆ˜ í˜¸ì¶œì´ ì•„ë‹ˆë¼ **ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì²˜ëŸ¼ ë™ì‘**í•œë‹¤.

- ì¦‰, **ìœ„ì¹˜ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤** ë‚´ë¶€ì ìœ¼ë¡œ ì½œë°± í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” **êµ¬ë…(subscribe) ë°©ì‹**
- ì´ ë§ì€ ê³§, **ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ë”ë¼ë„ `watchPosition`ì´ ê³„ì† ì‹¤í–‰ë  ìˆ˜ ìˆìŒ**ì„ ì˜ë¯¸

```jsx
useEffect(() => {
  const watchId = navigator.geolocation.watchPosition((position) => {
    console.log("ìœ„ì¹˜ ì—…ë°ì´íŠ¸ë¨:", position.coords.latitude, position.coords.longitude);
  });

  return () => navigator.geolocation.clearWatch(watchId); // ğŸ‘ˆ ì •ë¦¬ í•„ìš”!
}, []);
```

âœ… **`clearWatch(watchId)`ë¥¼ ì‹¤í–‰í•´ì•¼ ê¸°ì¡´ì˜ `watchPosition`ì„ ì •ë¦¬í•  ìˆ˜ ìˆìŒ.**

---

### ğŸ”´ **2ï¸âƒ£ `watchPosition`ì„ `clearWatch`í•˜ì§€ ì•Šìœ¼ë©´ ìƒê¸°ëŠ” ë¬¸ì œ**

### ğŸš¨ **1. ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ (Memory Leak)**

- `watchPosition`ì´ í•œ ë²ˆ ì‹¤í–‰ë˜ë©´, **ë¸Œë¼ìš°ì €ëŠ” ê³„ì†í•´ì„œ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜í–‰**í•¨.
- í•˜ì§€ë§Œ **ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ì–´ë„ ê¸°ì¡´ì˜ `watchPosition`ì´ ê³„ì† ì‹¤í–‰ë¨.**
- ğŸ’£ **ì¦‰, ì‚¬ë¼ì§„ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ ê³„ì† ìœ„ì¹˜ ì—…ë°ì´íŠ¸ê°€ ì‹¤í–‰ë˜ì–´ ë©”ëª¨ë¦¬ê°€ ë‚­ë¹„ë¨.**

### ğŸš¨ **2. ì¤‘ë³µ í˜¸ì¶œ ë°œìƒ**

- `useEffect`ê°€ ë‹¤ì‹œ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ **ìƒˆë¡œìš´ `watchPosition`ì´ ì¶”ê°€ë¨**
- ê·¸ëŸ¬ë©´ **ê¸°ì¡´ì˜ `watchPosition`ì´ ì¤‘ë‹¨ë˜ì§€ ì•Šê³ , ì—¬ëŸ¬ ê°œì˜ `watchPosition`ì´ ì‹¤í–‰ë¨.**
- ğŸ’£ **ì¦‰, ìœ„ì¹˜ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì—¬ëŸ¬ ê°œì˜ ì´ë²¤íŠ¸ê°€ ì‹¤í–‰ë˜ì–´ ë¶ˆí•„ìš”í•œ API ìš”ì²­ì´ ë°œìƒí•  ìˆ˜ë„ ìˆìŒ.**

### getWeeklyWeather

```jsx
export function getWeeklyWeather(
  dataList: WeatherWithDate[]
): WeeklyWeatherType[] {
  
  ...

  // ê°ì²´ë¥¼ { date, am, pm } í˜•íƒœì˜ ë°°ì—´ë¡œ ë³€í™˜
  return Object.entries(groupedWeather).map(([date, { am, pm }]) => ({
    date,
    am,
    pm,
  }));
}
```

```jsx
//groupedWeather

{
  "2025-02-16": { am: {ë‚ ì”¨ ë°ì´í„°}, pm: {ë‚ ì”¨ ë°ì´í„°} },
  "2025-02-17": { am: {ë‚ ì”¨ ë°ì´í„°} }
}

// Object.entries(groupedWeather)
[
  ["2025-02-16", { am: {ë‚ ì”¨ ë°ì´í„°}, pm: {ë‚ ì”¨ ë°ì´í„°} }],
  ["2025-02-17", { am: {ë‚ ì”¨ ë°ì´í„°} }]
]

// map
["2025-02-16", { am: {ë‚ ì”¨ ë°ì´í„°}, pm: {ë‚ ì”¨ ë°ì´í„°} }]
â†’ { date: "2025-02-16", am: {ë‚ ì”¨ ë°ì´í„°}, pm: {ë‚ ì”¨ ë°ì´í„°} }

["2025-02-17", { am: {ë‚ ì”¨ ë°ì´í„°} }]
â†’ { date: "2025-02-17", am: {ë‚ ì”¨ ë°ì´í„°}, pm: undefined }
```
